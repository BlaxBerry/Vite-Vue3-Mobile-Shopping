import{a5 as e,a6 as t,u as s,r as a,b as o,d as n,w as l,o as r,a9 as i,g as c,a8 as u,F as d,ab as m,ae as p,af as h,e as y,f as g,aa as w,a7 as S,c as k,ag as C}from"./vendor.26f587a3.js";import{i as f}from"./index.82f643de.js";/* empty css              */import{_ as v}from"./PropductCard.4a23aae5.js";import{_ as L}from"./Empty.2c0ab32f.js";async function R(t,s="desc",a="0",o=50,n=1){let l=e({list:[],menu:[],resPage:1});const r=await(i={keyword:t,order:s,categoryId:a,sort:"price",size:o,page:n},f({method:"GET",url:"/goods/list",params:i}));var i;return l.list=r.data.goodsList,l.menu=r.data.filterCategory,l.resPage=r.data.currentPage,l}const V={emits:["onGetInputVal"],setup(o,n){const l=t(),r=s();let i=a(""),c=e({});return{searchVal:i,onSearch:async()=>{c=await R(i.value.trim()),r.commit("getSearchValue",i.value),r.commit("getSearchResult",c),n.emit("onGetInputVal",i.value)},searchResult:c,onCancel:()=>{l.go(-1)}}}};V.render=function(e,t,s,a,c,u){const d=o("van-search");return r(),n(d,{background:"white","show-action":"",placeholder:"Search Goods",modelValue:a.searchVal,"onUpdate:modelValue":t[1]||(t[1]=e=>a.searchVal=e),onSearch:a.onSearch},{action:l((()=>[i("div",{onClick:t[0]||(t[0]=(...e)=>a.onCancel&&a.onCancel(...e))},"Cancel")])),_:1},8,["modelValue","onSearch"])};function P(){let t=e({historyList:[],hotList:[]});return(async()=>{const e=await f({method:"GET",url:"/search/index"});t.historyList=e.data.historyKeywordList,t.hotList=e.data.hotKeywordList})(),{keywordsList:t}}const x={emits:["onShowResult"],setup(t,a){const o=s();let n=e([]),{keywordsList:l}=P();n=l;let r=e({});return{list:n,goPopupResList:async e=>{r=await R(e),o.commit("getSearchResult",r),a.emit("onShowResult",!1)},clear:()=>{f({method:"GET",url:"/search/clearhistory"}).then((()=>{let{keywordsList:e}=P();n.historyList=e.historyList,m.success("成功删除")}))}}}},E={class:"title"},I={key:0,class:"tags"},K={key:1,class:"tags"};x.render=function(e,t,s,a,l,m){const k=o("van-icon"),C=o("van-tag");return r(!0),c(d,null,u(a.list,((e,t)=>p((r(),c("div",{key:e,class:"popup-keywords"},[i("div",E,[i("h4",null,[y(k,{name:"historyList"==t?"clock-o":"fire-o",size:"0.5rem",color:"hotList"==t?"#ff6034":""},null,8,["name","color"]),g(" "+w(t.replace("List","").toUpperCase()),1)]),"historyList"==t?(r(),n(k,{key:0,name:"delete-o",onClick:a.clear},null,8,["onClick"])):S("",!0)]),"historyList"==t?(r(),c("div",I,[(r(!0),c(d,null,u(e,(e=>(r(),n(C,{key:e,plain:"",type:1==e.is_hot?"danger":"default",textContent:w(e),onClick:t=>a.goPopupResList(e)},null,8,["type","textContent","onClick"])))),128))])):S("",!0),"hotList"==t?(r(),c("div",K,[(r(!0),c(d,null,u(e,(e=>(r(),n(C,{key:e,plain:"",color:1==e.is_hot?"#ff6034":"",textContent:w(e.keyword),onClick:t=>a.goPopupResList(e.keyword)},null,8,["color","textContent","onClick"])))),128))])):S("",!0)],512)),[[h,0!=e.length]]))),128)};const G={props:["list"],setup(e){const t=s(),o=a("desc"),n=a(0),l=JSON.parse(JSON.stringify(e.list).replace(/name/g,"text").replace(/id/g,"value"));l.map((e=>{e.checked&&(n.value=e.value)}));let r=k((()=>t.state.searchValue));return{menuPriceItems:[{text:"高い順",value:"desc"},{text:"安い順",value:"asc"}],menuPriceSelected:o,menuCategaryItems:l,menuCategarySelected:n,changeSelected:async()=>{let e=await R(r.value,o.value,n.value.toString());t.commit("getSearchResult",e),console.log(e)}}}};G.render=function(e,t,s,a,i,c){const u=o("van-dropdown-item"),d=o("van-dropdown-menu");return r(),n(d,null,{default:l((()=>[y(u,{title:"All",disabled:""}),y(u,{modelValue:a.menuPriceSelected,"onUpdate:modelValue":t[0]||(t[0]=e=>a.menuPriceSelected=e),options:a.menuPriceItems,onChange:a.changeSelected},null,8,["modelValue","options","onChange"]),y(u,{modelValue:a.menuCategarySelected,"onUpdate:modelValue":t[1]||(t[1]=e=>a.menuCategarySelected=e),options:a.menuCategaryItems,onChange:a.changeSelected},null,8,["modelValue","options","onChange"])])),_:1})};const O={components:{Menu:G,Cards:v,Empty:L},setup(){const e=s();return{isEmptyRes:k((()=>e.getters.isEmptyList)),resList:k((()=>e.getters.list)),resMenu:k((()=>e.getters.menu))}}};O.render=function(e,t,s,a,l,i){const u=o("Menu"),m=o("Cards"),p=o("Empty");return r(),c(d,null,[a.isEmptyRes?S("",!0):(r(),n(u,{key:0,list:a.resMenu},null,8,["list"])),a.isEmptyRes?S("",!0):(r(),n(m,{key:1,list:a.resList},null,8,["list"])),a.isEmptyRes?(r(),n(p,{key:2})):S("",!0)],64)};const _={components:{SearchBar:V,Keywords:x,ResultList:O},setup(){let e=a(!0),t=a(!0);return{isPopupShow:e,isShowKeywords:t,toggleKeywordsOrResult:e=>{t.value=!e},showResult:e=>{t.value=e}}}},b={key:0,class:"popup"};_.render=function(e,t,s,a,i,u){const d=o("SearchBar"),m=o("Keywords"),p=o("ResultList");return"/home/search"==e.$route.path?(r(),n(C,{key:0,name:"van-slide-right",appear:""},{default:l((()=>[a.isPopupShow?(r(),c("div",b,[y(d,{onOnGetInputVal:a.toggleKeywordsOrResult},null,8,["onOnGetInputVal"]),a.isShowKeywords?(r(),n(m,{key:0,onOnShowResult:a.showResult},null,8,["onOnShowResult"])):S("",!0),a.isShowKeywords?S("",!0):(r(),n(p,{key:1}))])):S("",!0)])),_:1})):S("",!0)};export{_ as default};
